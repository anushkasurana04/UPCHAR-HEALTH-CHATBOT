<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Chatbot - AI Assistant</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            margin: 0;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            border-radius: 25px;
            padding: 10px 30px;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .navbar {
            background: rgba(255,255,255,0.95) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .page-container {
            display: none;
            min-height: 100vh;
        }
        
        .page-container.active {
            display: block;
        }
        
        .message {
            margin-bottom: 15px;
            animation: fadeInUp 0.3s ease;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message .message-content {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 18px 18px 4px 18px;
            padding: 12px 18px;
            max-width: 70%;
            margin-left: auto;
            display: inline-block;
            word-wrap: break-word;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }
        
        .bot-message .message-content {
            background: #f8f9fa;
            color: #333;
            border-radius: 18px 18px 18px 4px;
            padding: 12px 18px;
            max-width: 80%;
            display: inline-block;
            word-wrap: break-word;
            white-space: pre-wrap;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .typing-dots {
            display: inline-block;
        }
        
        .typing-dots span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #999;
            margin: 0 2px;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { 
                transform: scale(0);
                opacity: 0.5;
            } 
            40% { 
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .chat-input-area {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid #e0e0e0;
            padding: 20px;
            position: sticky;
            bottom: 0;
        }
        
        .quick-btn {
            border-radius: 20px;
            font-size: 0.85rem;
            margin: 2px;
            transition: all 0.3s ease;
        }
        
        .quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }
        
        #chat-messages {
            background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
            height: calc(100vh - 200px);
            overflow-y: auto;
            padding: 20px;
        }
        
        .hero-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            color: white;
            margin: 50px auto;
            animation: fadeIn 1s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .feature-card {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .feature-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .alert-custom {
            border-radius: 10px;
            border: none;
            margin: 10px 0;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 10px 20px;
            border-radius: 25px;
            background: rgba(40, 167, 69, 0.9);
            color: white;
            font-size: 0.9rem;
            display: none;
        }
        
        .emergency-alert {
            background: linear-gradient(45deg, #dc3545, #c82333) !important;
            color: white !important;
            border: 2px solid #ff0000 !important;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }
        
        .chat-stats {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            color: #666;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }
        
        .multilingual-toggle {
            position: fixed;
            top: 70px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.8rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <!-- Status Indicator -->
    <div id="status-indicator" class="status-indicator">
        <i class="fas fa-wifi me-2"></i>Connected
    </div>

    <!-- Multilingual Toggle -->
    <button id="lang-toggle" class="multilingual-toggle" onclick="toggleLanguage()">
        <i class="fas fa-language me-1"></i><span id="lang-text">EN</span>
    </button>

    <!-- Chat Stats -->
    <div id="chat-stats" class="chat-stats">
        <i class="fas fa-chart-line me-1"></i>
        <span id="message-count">0</span> messages • 
        <span id="session-time">0s</span> active
    </div>

    <!-- Landing Page -->
    <div id="landing" class="page-container active">
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container">
                <div class="navbar-brand">
                    <i class="fas fa-robot text-primary me-2"></i>
                    <strong>Health Assistant AI</strong>
                </div>
                <div class="navbar-nav ms-auto">
                    <button class="btn btn-outline-primary me-2" onclick="showLogin()">
                        <i class="fas fa-sign-in-alt me-1"></i>Login
                    </button>
                    <button class="btn btn-primary" onclick="showSignup()">
                        <i class="fas fa-user-plus me-1"></i>Sign Up
                    </button>
                </div>
            </div>
        </nav>
        
        <div class="container">
            <div class="hero-section">
                <i class="fas fa-user-md fa-5x mb-4"></i>
                <h1 class="display-4 mb-4">AI Health Assistant</h1>
                <p class="lead mb-4">Your intelligent 24/7 health companion for symptom checking, health awareness, and wellness guidance with multilingual support</p>
                <button class="btn btn-light btn-lg me-3" onclick="showDemo()">
                    <i class="fas fa-play me-2"></i>Try Live Demo
                </button>
                <button class="btn btn-outline-light btn-lg" onclick="showLogin()">
                    <i class="fas fa-user me-2"></i>Login to Start
                </button>
            </div>
            
            <div class="row">
                <div class="col-md-4 d-flex">
                    <div class="feature-card text-center">
                        <i class="fas fa-stethoscope fa-3x text-primary mb-3"></i>
                        <h4>Smart Symptom Checker</h4>
                        <p>Advanced AI analyzes 50+ medical conditions with emergency detection. Supports English and Hindi languages.</p>
                        <small class="text-muted">✓ Emergency alerts ✓ Medical disclaimers</small>
                    </div>
                </div>
                <div class="col-md-4 d-flex">
                    <div class="feature-card text-center">
                        <i class="fas fa-globe fa-3x text-success mb-3"></i>
                        <h4>Multilingual Support</h4>
                        <p>Communicate in English or Hindi with automatic translation and culturally appropriate responses.</p>
                        <small class="text-muted">✓ Auto-detection ✓ Real-time translation</small>
                    </div>
                </div>
                <div class="col-md-4 d-flex">
                    <div class="feature-card text-center">
                        <i class="fas fa-bell fa-3x text-warning mb-3"></i>
                        <h4>Health Management</h4>
                        <p>Set vaccination reminders, track health goals, and receive personalized wellness tips.</p>
                        <small class="text-muted">✓ Smart reminders ✓ Personal tracking</small>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12 text-center">
                    <div class="feature-card">
                        <h5 class="mb-3">🌟 Premium Features</h5>
                        <div class="row text-start">
                            <div class="col-md-6">
                                <p><i class="fas fa-check text-success me-2"></i>Real-time chat interface</p>
                                <p><i class="fas fa-check text-success me-2"></i>Emergency condition detection</p>
                                <p><i class="fas fa-check text-success me-2"></i>Vaccination scheduling</p>
                            </div>
                            <div class="col-md-6">
                                <p><i class="fas fa-check text-success me-2"></i>Mental health support</p>
                                <p><i class="fas fa-check text-success me-2"></i>Secure user accounts</p>
                                <p><i class="fas fa-check text-success me-2"></i>Chat history storage</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Page -->
    <div id="login" class="page-container">
        <div class="container-fluid h-100 d-flex align-items-center justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="card">
                    <div class="card-body p-5">
                        <div class="text-center mb-4">
                            <i class="fas fa-user-md fa-3x text-primary mb-3"></i>
                            <h2 class="text-dark">Welcome Back</h2>
                            <p class="text-muted">Sign in to your health assistant</p>
                        </div>
                        
                        <div id="login-alerts"></div>
                        
                        <form id="login-form">
                            <div class="mb-3">
                                <label for="login-username" class="form-label">Username</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-user"></i></span>
                                    <input type="text" class="form-control" id="login-username" placeholder="Enter username" required>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label for="login-password" class="form-label">Password</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                    <input type="password" class="form-control" id="login-password" placeholder="Enter password" required>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary w-100 mb-3">
                                <i class="fas fa-sign-in-alt me-2"></i>Sign In
                            </button>
                        </form>
                        
                        <div class="text-center">
                            <p class="text-muted">Don't have an account? 
                                <a href="#" onclick="showSignup()" class="text-primary text-decoration-none">Sign up here</a>
                            </p>
                            <p class="text-muted small">Demo credentials: <code>demo / password</code></p>
                            <a href="#" onclick="showLanding()" class="text-secondary text-decoration-none">
                                <i class="fas fa-arrow-left me-1"></i>Back to Home
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Signup Page -->
    <div id="signup" class="page-container">
        <div class="container-fluid h-100 d-flex align-items-center justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="card">
                    <div class="card-body p-5">
                        <div class="text-center mb-4">
                            <i class="fas fa-user-plus fa-3x text-primary mb-3"></i>
                            <h2 class="text-dark">Join Our Community</h2>
                            <p class="text-muted">Create your health assistant account</p>
                        </div>
                        
                        <div id="signup-alerts"></div>
                        
                        <form id="signup-form">
                            <div class="mb-3">
                                <label for="signup-username" class="form-label">Username</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-user"></i></span>
                                    <input type="text" class="form-control" id="signup-username" placeholder="Choose username" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="signup-email" class="form-label">Email Address</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                                    <input type="email" class="form-control" id="signup-email" placeholder="Enter email" required>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label for="signup-password" class="form-label">Password</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                    <input type="password" class="form-control" id="signup-password" placeholder="Create password" required>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary w-100 mb-3">
                                <i class="fas fa-user-plus me-2"></i>Create Account
                            </button>
                        </form>
                        
                        <div class="text-center">
                            <p class="text-muted">Already have an account? 
                                <a href="#" onclick="showLogin()" class="text-primary text-decoration-none">Sign in here</a>
                            </p>
                            <a href="#" onclick="showLanding()" class="text-secondary text-decoration-none">
                                <i class="fas fa-arrow-left me-1"></i>Back to Home
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Interface -->
    <div id="chat" class="page-container">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <div class="navbar-brand">
                    <i class="fas fa-robot text-primary me-2"></i>
                    <strong>Health Assistant</strong>
                    <span id="online-status" class="badge bg-success ms-2">Online</span>
                </div>
                <div class="navbar-nav ms-auto d-flex align-items-center">
                    <span class="navbar-text me-3">
                        <i class="fas fa-user me-1"></i>
                        <span id="current-username">User</span>
                        <small class="text-muted ms-2">Active</small>
                    </span>
                    <button class="btn btn-outline-primary btn-sm me-2" onclick="clearChat()">
                        <i class="fas fa-trash me-1"></i>Clear Chat
                    </button>
                    <a class="nav-link" href="#" onclick="logout()">
                        <i class="fas fa-sign-out-alt me-1"></i>Logout
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="container-fluid p-0">
            <div class="row g-0">
                <div class="col-12">
                    <!-- Chat Messages Area -->
                    <div id="chat-messages">
                        <!-- Initial bot message will be added by JavaScript -->
                    </div>
                    
                    <!-- Input Area -->
                    <div class="chat-input-area">
                        <div class="container">
                            <div class="row g-3">
                                <div class="col-12">
                                    <div class="input-group">
                                        <input type="text" 
                                               id="message-input" 
                                               class="form-control" 
                                               placeholder="Type your message or describe symptoms..."
                                               autocomplete="off">
                                        <button class="btn btn-primary" 
                                                id="send-btn" 
                                                type="button">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="d-flex gap-2 flex-wrap justify-content-center">
                                        <button class="btn btn-outline-primary btn-sm quick-btn" onclick="quickMessage('I have fever and cough')">
                                            <i class="fas fa-thermometer-half me-1"></i>Fever & Cough
                                        </button>
                                        <button class="btn btn-outline-danger btn-sm quick-btn" onclick="quickMessage('chest pain and sweating')">
                                            <i class="fas fa-heart me-1"></i>Chest Pain
                                        </button>
                                        <button class="btn btn-outline-success btn-sm quick-btn" onclick="quickMessage('Tell me about vaccines')">
                                            <i class="fas fa-syringe me-1"></i>Vaccines
                                        </button>
                                        <button class="btn btn-outline-info btn-sm quick-btn" onclick="quickMessage('Give me health tips')">
                                            <i class="fas fa-apple-alt me-1"></i>Health Tips
                                        </button>
                                        <button class="btn btn-outline-warning btn-sm quick-btn" onclick="quickMessage('I feel stressed and anxious')">
                                            <i class="fas fa-brain me-1"></i>Mental Health
                                        </button>
                                        <button class="btn btn-outline-secondary btn-sm quick-btn" onclick="showReminderModal()">
                                            <i class="fas fa-bell me-1"></i>Set Reminder
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reminder Modal -->
    <div class="modal fade" id="reminderModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-bell text-warning me-2"></i>Set Health Reminder
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="reminderText" class="form-label">Reminder Description</label>
                        <input type="text" class="form-control" id="reminderText" 
                               placeholder="e.g., Take flu vaccine, Annual checkup, Blood pressure check">
                    </div>
                    <div class="mb-3">
                        <label for="reminderDays" class="form-label">Remind me in</label>
                        <select class="form-select" id="reminderDays">
                            <option value="1">1 day</option>
                            <option value="7">1 week</option>
                            <option value="30" selected>1 month</option>
                            <option value="90">3 months</option>
                            <option value="180">6 months</option>
                            <option value="365">1 year</option>
                        </select>
                    </div>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <small>In the full application, you'll receive email/SMS notifications for your reminders.</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveReminder()">
                        <i class="fas fa-save me-1"></i>Set Reminder
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global application state
        let appState = {
            currentUser: null,
            isLoggedIn: false,
            currentLanguage: 'en',
            messageCount: 0,
            sessionStart: Date.now(),
            users: JSON.parse(localStorage.getItem('healthbot_users') || '{}'),
            chatHistory: JSON.parse(localStorage.getItem('healthbot_chats') || '{}'),
            reminders: JSON.parse(localStorage.getItem('healthbot_reminders') || '[]')
        };

        // Enhanced symptom knowledge base with multilingual support
        const symptomDatabase = {
            "fever, cough": {
                en: "Flu or common viral infection",
                hi: "फ्लू या सामान्य वायरल संक्रमण"
            },
            "fever, body pain, headache": {
                en: "Dengue fever",
                hi: "डेंगू बुखार"
            },
            "persistent cough, weight loss, night sweats": {
                en: "Tuberculosis (TB)",
                hi: "तपेदिक (टीबी)"
            },
            "fever, chills, sweating": {
                en: "Malaria",
                hi: "मलेरिया"
            },
            "chest pain, shortness of breath": {
                en: "Possible heart condition or pneumonia",
                hi: "संभावित हृदय रोग या निमोनिया"
            },
            "nausea, vomiting, stomach pain": {
                en: "Gastroenteritis or food poisoning",
                hi: "गैस्ट्रोएंटेराइटिस या फूड पॉइजनिंग"
            },
            "headache, sensitivity to light, stiff neck": {
                en: "Possible meningitis - EMERGENCY",
                hi: "संभावित मेनिनजाइटिस - आपातकाल"
            },
            "severe chest pain, arm pain, sweating": {
                en: "Possible heart attack - EMERGENCY",
                hi: "संभावित हार्ट अटैक - आपातकाल"
            },
            "sudden weakness, speech problems, confusion": {
                en: "Possible stroke - EMERGENCY",
                hi: "संभावित स्ट्रोक - आपातकाल"
            },
            "difficulty breathing, wheezing": {
                en: "Asthma or respiratory infection",
                hi: "अस्थमा या सांस की संक्रमण"
            },
            "severe abdominal pain, fever": {
                en: "Appendicitis or severe infection",
                hi: "अपेंडिसाइटिस या गंभीर संक्रमण"
            },
            "diarrhea, fever, dehydration": {
                en: "Gastroenteritis or bacterial infection",
                hi: "गैस्ट्रोएंटेराइटिस या बैक्टीरियल संक्रमण"
            },
            "sore throat, fever, swollen glands": {
                en: "Strep throat or viral infection",
                hi: "गले की संक्रमण या वायरल संक्रमण"
            },
            "fatigue, pale skin, shortness of breath": {
                en: "Possible anemia",
                hi: "संभावित एनीमिया"
            }
        };

        // Language detection and translation (simplified)
        function detectLanguage(text) {
            const hindiPattern = /[\u0900-\u097F]/;
            return hindiPattern.test(text) ? 'hi' : 'en';
        }

        function translate(text, targetLang) {
            // Simple translation mapping for demo
            const translations = {
                en: {
                    'बुखार': 'fever',
                    'खांसी': 'cough',
                    'सिरदर्द': 'headache',
                    'पेट दर्द': 'stomach pain',
                    'सांस लेने में तकलीफ': 'difficulty breathing'
                },
                hi: {
                    'fever': 'बुखार',
                    'cough': 'खांसी',
                    'headache': 'सिरदर्द',
                    'stomach pain': 'पेट दर्द',
                    'difficulty breathing': 'सांस लेने में तकलीफ'
                }
            };

            let result = text;
            if (translations[targetLang]) {
                Object.keys(translations[targetLang]).forEach(key => {
                    const regex = new RegExp(key, 'gi');
                    result = result.replace(regex, translations[targetLang][key]);
                });
            }
            return result;
        }

        // Enhanced navigation functions
        function showPage(pageId) {
            document.querySelectorAll('.page-container').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // Update status indicator
            updateStatusIndicator(pageId);
            
            // Page-specific setup
            if (pageId === 'chat') {
                startSessionTimer();
                document.getElementById('chat-stats').style.display = 'block';
                focusMessageInput();
            } else {
                document.getElementById('chat-stats').style.display = 'none';
            }
        }

        function showLanding() { showPage('landing'); }
        function showLogin() { showPage('login'); }
        function showSignup() { showPage('signup'); }
        function showChat() { showPage('chat'); }

        function showDemo() {
            appState.currentUser = 'Demo User';
            appState.isLoggedIn = true;
            document.getElementById('current-username').textContent = appState.currentUser;
            showChat();
            initializeChatMessages();
            addBotMessage("🎉 Welcome to the live demo! I'm your AI health assistant.\n\nTry these features:\n• Type symptoms like 'fever and cough'\n• Click quick buttons for instant help\n• Test emergency detection with 'chest pain'\n• Ask about vaccines or health tips\n• Set a reminder using the button below\n\n⚠️ This is a fully functional demo with data persistence!");
        }

        function logout() {
            // Save chat history before logout
            if (appState.currentUser && appState.isLoggedIn) {
                saveChatHistory();
            }
            
            appState.currentUser = null;
            appState.isLoggedIn = false;
            appState.messageCount = 0;
            clearChatMessages();
            showLanding();
            updateStatusIndicator('landing');
        }

        // Enhanced authentication system with data persistence
        function registerUser(username, email, password) {
            if (appState.users[username]) {
                return { success: false, message: 'Username already exists!' };
            }
            
            // Check for duplicate email
            for (let user of Object.values(appState.users)) {
                if (user.email === email) {
                    return { success: false, message: 'Email already registered!' };
                }
            }
            
            appState.users[username] = {
                email: email,
                password: hashPassword(password),
                created: new Date().toISOString(),
                lastLogin: null
            };
            
            localStorage.setItem('healthbot_users', JSON.stringify(appState.users));
            return { success: true, message: 'Account created successfully!' };
        }

        function loginUser(username, password) {
            const user = appState.users[username];
            if (!user || user.password !== hashPassword(password)) {
                return { success: false, message: 'Invalid username or password!' };
            }
            
            user.lastLogin = new Date().toISOString();
            appState.users[username] = user;
            localStorage.setItem('healthbot_users', JSON.stringify(appState.users));
            
            return { success: true, message: 'Login successful!' };
        }

        // Simple hash function for demo (not secure for production)
        function hashPassword(password) {
            let hash = 0;
            for (let i = 0; i < password.length; i++) {
                const char = password.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return hash.toString();
        }

        // Authentication event handlers
        document.getElementById('signup-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('signup-username').value.trim();
            const email = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value;
            
            if (!username || !email || !password) {
                showAlert('signup-alerts', 'All fields are required!', 'error');
                return;
            }
            
            if (password.length < 6) {
                showAlert('signup-alerts', 'Password must be at least 6 characters long!', 'error');
                return;
            }
            
            const result = registerUser(username, email, password);
            showAlert('signup-alerts', result.message, result.success ? 'success' : 'error');
            
            if (result.success) {
                setTimeout(() => {
                    clearForm('signup-form');
                    showLogin();
                }, 2000);
            }
        });

        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;
            
            if (!username || !password) {
                showAlert('login-alerts', 'Please fill in all fields!', 'error');
                return;
            }
            
            const result = loginUser(username, password);
            showAlert('login-alerts', result.message, result.success ? 'success' : 'error');
            
            if (result.success) {
                appState.currentUser = username;
                appState.isLoggedIn = true;
                document.getElementById('current-username').textContent = username;
                
                setTimeout(() => {
                    clearForm('login-form');
                    showChat();
                    initializeChatMessages();
                    loadChatHistory();
                }, 1000);
            }
        });

        function showAlert(containerId, message, type) {
            const alertClass = type === 'error' ? 'alert-danger' : 'alert-success';
            const iconClass = type === 'error' ? 'fas fa-exclamation-triangle' : 'fas fa-check-circle';
            
            document.getElementById(containerId).innerHTML = `
                <div class="alert ${alertClass} alert-custom alert-dismissible fade show" role="alert">
                    <i class="${iconClass} me-2"></i>${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
        }

        function clearForm(formId) {
            document.getElementById(formId).reset();
        }

        // Enhanced chat system with persistence
        function initializeChatMessages() {
            const chatMessages = document.getElementById('chat-messages');
            chatMessages.innerHTML = '';
            
            const welcomeMessage = appState.currentLanguage === 'hi' ? 
                `नमस्ते! मैं आपका AI स्वास्थ्य सहायक हूं। मैं आपकी मदद कर सकता हूं:\n\n• लक्षण जांच (अपने लक्षण बताएं)\n• स्वास्थ्य और कल्याण सुझाव\n• टीकाकरण जानकारी\n• स्वास्थ्य रिमाइंडर सेट करना\n\n⚠️ यह केवल जागरूकता के लिए है। चिकित्सा सलाह के लिए हमेशा डॉक्टर से सलाह लें।` :
                `Hello! I'm your AI health assistant. I can help you with:\n\n• Symptom checking (describe your symptoms)\n• Health and wellness tips\n• Vaccination information\n• Setting health reminders\n\n⚠️ This is for awareness only. Always consult a doctor for medical advice.`;
            
            addBotMessage(welcomeMessage);
        }

        function addUserMessage(message) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            messageDiv.innerHTML = `
                <div class="d-flex align-items-start justify-content-end">
                    <div class="message-content">
                        ${escapeHtml(message)}
                        <div class="small text-white-50 mt-1">${new Date().toLocaleTimeString()}</div>
                    </div>
                    <div class="avatar bg-primary text-white ms-3">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
            
            appState.messageCount++;
            updateChatStats();
        }

        function addBotMessage(message, isEmergency = false) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            
            const messageClass = isEmergency ? 'message-content emergency-alert' : 'message-content';
            const emergencyIcon = isEmergency ? '<i class="fas fa-exclamation-triangle me-2"></i>' : '';
            
            messageDiv.innerHTML = `
                <div class="d-flex align-items-start">
                    <div class="avatar bg-success text-white me-3">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="${messageClass}">
                        ${emergencyIcon}${formatMessage(message)}
                        <div class="small text-muted mt-1">${new Date().toLocaleTimeString()}</div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
            
            // Play notification sound for emergencies (simulated)
            if (isEmergency) {
                showEmergencyNotification();
            }
        }

        function showTypingIndicator() {
            const chatMessages = document.getElementById('chat-messages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'message bot-message';
            typingDiv.innerHTML = `
                <div class="d-flex align-items-start">
                    <div class="avatar bg-success text-white me-3">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <div class="typing-dots">
                            <span></span><span></span><span></span>
                        </div>
                        <small class="text-muted">AI is thinking...</small>
                    </div>
                </div>
            `;
            chatMessages.appendChild(typingDiv);
            scrollToBottom();
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) {
                indicator.remove();
            }
        }

        // Enhanced symptom checking with multilingual support
        function checkSymptoms(symptoms) {
            const symptomsLower = symptoms.toLowerCase();
            
            // First, translate symptoms if in Hindi
            const detectedLang = detectLanguage(symptoms);
            const translatedSymptoms = detectedLang === 'hi' ? translate(symptoms, 'en') : symptoms;
            
            for (const [pattern, diseaseObj] of Object.entries(symptomDatabase)) {
                const patternWords = pattern.split(', ');
                const matchCount = patternWords.filter(word => 
                    translatedSymptoms.toLowerCase().includes(word) || 
                    symptomsLower.includes(word)
                ).length;
                
                if (matchCount >= Math.ceil(patternWords.length * 0.6)) {
                    const disease = diseaseObj[appState.currentLanguage] || diseaseObj.en;
                    return {
                        disease: disease,
                        isEmergency: disease.includes('EMERGENCY') || disease.includes('आपातकाल')
                    };
                }
            }
            return null;
        }

        // Enhanced response generation
        function generateResponse(message) {
            const messageLower = message.toLowerCase();
            const detectedLang = detectLanguage(message);
            
            // Update current language based on user input
            if (detectedLang === 'hi' && appState.currentLanguage === 'en') {
                appState.currentLanguage = 'hi';
                document.getElementById('lang-text').textContent = 'HI';
            }
            
            // Symptom checking
            if (messageLower.includes('fever') || messageLower.includes('cough') || 
                messageLower.includes('pain') || messageLower.includes('headache') ||
                messageLower.includes('symptom') || messageLower.includes('sick') ||
                messageLower.includes('hurt') || messageLower.includes('ache') ||
                messageLower.includes('बुखार') || messageLower.includes('खांसी') ||
                messageLower.includes('दर्द') || messageLower.includes('सिरदर्द')) {
                
                const result = checkSymptoms(message);
                
                if (result) {
                    let response;
                    if (result.isEmergency) {
                        response = appState.currentLanguage === 'hi' ?
                            `🚨 तत्काल: आपके लक्षणों के आधार पर, यह ${result.disease.replace(' - आपातकाल', '')} हो सकता है।\n\nकृपया तत्काल चिकित्सा सहायता लें या आपातकालीन सेवाओं को कॉल करें!\n\n⚠️ अस्वीकरण: यह केवल जागरूकता की जानकारी है और पेशेवर चिकित्सा सलाह का विकल्प नहीं होनी चाहिए।` :
                            `🚨 URGENT: Based on your symptoms, this could be ${result.disease.replace(' - EMERGENCY', '')}.\n\nPlease seek immediate medical attention or call emergency services!\n\n⚠️ Disclaimer: This is only awareness information and should not replace professional medical advice.`;
                    } else {
                        response = appState.currentLanguage === 'hi' ?
                            `आपके लक्षणों के आधार पर, आपको ${result.disease} हो सकता है।\n\nयह केवल जागरूकता के उद्देश्य से है। कृपया उचित निदान और उपचार के लिए तुरंत डॉक्टर से सलाह लें।\n\n⚠️ अस्वीकरण: यह केवल जागरूकता की जानकारी है और योग्य डॉक्टर की सटीक सलाह का विकल्प नहीं होनी चाहिए।` :
                            `Based on your symptoms, you may have ${result.disease}.\n\nThis is only for awareness purposes. Please consult a doctor immediately for proper diagnosis and treatment.\n\n⚠️ Disclaimer: This is only awareness information and should not replace professional medical advice.`;
                    }
                    return { text: response, isEmergency: result.isEmergency };
                } else {
                    const response = appState.currentLanguage === 'hi' ?
                        `मैं दिए गए लक्षणों के आधार पर आपकी स्थिति की पहचान नहीं कर सका।\n\nकृपया उचित चिकित्सा मूल्यांकन और सलाह के लिए डॉक्टर से सलाह लें।\n\n⚠️ अस्वीकरण: यह केवल जागरूकता की जानकारी है।` :
                        `I could not identify your condition based on the symptoms provided.\n\nPlease consult a doctor for proper medical evaluation and advice.\n\n⚠️ Disclaimer: This is only awareness information.`;
                    return { text: response, isEmergency: false };
                }
            }
            
            // Vaccination information
            if (messageLower.includes('vaccine') || messageLower.includes('vaccination') ||
                messageLower.includes('टीका') || messageLower.includes('वैक्सीन')) {
                const response = appState.currentLanguage === 'hi' ?
                    `टीके बीमारियों को रोकने के लिए महत्वपूर्ण हैं। सामान्य टीके शामिल हैं:\n\n• COVID-19 वैक्सीन (सिफारिश के अनुसार बूस्टर)\n• फ्लू वैक्सीन (वार्षिक)\n• हेपेटाइटिस B\n• टेटनस (हर 10 साल)\n• MMR (खसरा, मम्प्स, रूबेला)\n\nव्यक्तिगत टीकाकरण अनुसूची के लिए कृपया अपने डॉक्टर से सलाह लें।\n\n⚠️ यह केवल जागरूकता की जानकारी है।` :
                    `Vaccines are crucial for preventing diseases. Common vaccines include:\n\n• COVID-19 vaccine (boosters as recommended)\n• Flu vaccine (annually)\n• Hepatitis B\n• Tetanus (every 10 years)\n• MMR (Measles, Mumps, Rubella)\n\nPlease consult your doctor for personalized vaccination schedules.\n\n⚠️ This is only awareness information.`;
                return { text: response, isEmergency: false };
            }
            
            // Health tips
            if (messageLower.includes('health tip') || messageLower.includes('wellness') || 
                messageLower.includes('healthy') || messageLower.includes('diet') ||
                messageLower.includes('स्वास्थ्य') || messageLower.includes('आहार')) {
                const response = appState.currentLanguage === 'hi' ?
                    `यहाँ कुछ आवश्यक स्वास्थ्य सुझाव हैं:\n\n🥗 आहार और पोषण:\n• दैनिक 5-9 बार फल और सब्जियां खाएं\n• परिष्कृत अनाज के बजाय साबुत अनाज चुनें\n• दुबला प्रोटीन शामिल करें (मछली, मुर्गी, दाल)\n• प्रसंस्कृत खाद्य पदार्थ और चीनी सीमित करें\n• दैनिक 8-10 गिलास पानी पिएं\n\n🏃‍♂️ व्यायाम:\n• साप्ताहिक कम से कम 150 मिनट मध्यम व्यायाम\n• सप्ताह में 2-3 बार शक्ति प्रशिक्षण शामिल करें\n\n😴 नींद और मानसिक स्वास्थ्य:\n• 7-9 घंटे गुणवत्तापूर्ण नींद लें\n• तनाव प्रबंधन तकनीकों का अभ्यास करें\n\n⚠️ यह केवल जागरूकता की जानकारी है।` :
                    `Here are some essential health tips:\n\n🥗 Diet & Nutrition:\n• Eat 5-9 servings of fruits and vegetables daily\n• Choose whole grains over refined grains\n• Include lean proteins (fish, poultry, legumes)\n• Limit processed foods and added sugars\n• Drink 8-10 glasses of water daily\n\n🏃‍♂️ Exercise:\n• At least 150 minutes of moderate exercise weekly\n• Include strength training 2-3 times per week\n• Take regular breaks from sitting\n\n😴 Sleep & Mental Health:\n• Get 7-9 hours of quality sleep\n• Practice stress management techniques\n• Maintain social connections\n\n⚠️ This is only awareness information.`;
                return { text: response, isEmergency: false };
            }
            
            // Mental health
            if (messageLower.includes('stress') || messageLower.includes('anxiety') || 
                messageLower.includes('depression') || messageLower.includes('mental') ||
                messageLower.includes('तनाव') || messageLower.includes('चिंता') ||
                messageLower.includes('अवसाद') || messageLower.includes('मानसिक')) {
                const response = appState.currentLanguage === 'hi' ?
                    `मानसिक स्वास्थ्य शारीरिक स्वास्थ्य जितना ही महत्वपूर्ण है। देखने योग्य संकेत:\n\n🧠 चेतावनी संकेत:\n• लगातार उदासी या चिंता\n• नींद या भूख में बदलाव\n• गतिविधियों में रुचि की हानि\n• ध्यान केंद्रित करने में कठिनाई\n• आत्म-हानि के विचार\n\n💡 सहायक रणनीतियां:\n• नियमित व्यायाम और स्वस्थ आहार\n• पर्याप्त नींद (7-9 घंटे)\n• माइंडफुलनेस और विश्राम तकनीकें\n• सामाजिक समर्थन और संबंध\n• आवश्यकता पड़ने पर पेशेवर परामर्श\n\nयदि आप मानसिक स्वास्थ्य चुनौतियों का सामना कर रहे हैं, तो कृपया तुरंत पेशेवर मदद लें।\n\n⚠️ यह केवल जागरूकता की जानकारी है।` :
                    `Mental health is as important as physical health. Signs to watch for:\n\n🧠 Warning Signs:\n• Persistent sadness or anxiety\n• Changes in sleep or appetite\n• Loss of interest in activities\n• Difficulty concentrating\n• Thoughts of self-harm\n\n💡 Helpful Strategies:\n• Regular exercise and healthy diet\n• Adequate sleep (7-9 hours)\n• Mindfulness and relaxation techniques\n• Social support and connections\n• Professional counseling when needed\n\nIf you're experiencing mental health challenges, please seek professional help immediately.\n\n🆘 Emergency Resources:\n• National Suicide Prevention Lifeline: 988\n• Crisis Text Line: Text HOME to 741741\n\n⚠️ This is only awareness information.`;
                return { text: response, isEmergency: false };
            }
            
            // General response
            const response = appState.currentLanguage === 'hi' ?
                `मैं स्वास्थ्य जागरूकता जानकारी प्रदान करने के लिए यहाँ हूँ। आप मुझसे पूछ सकते हैं:\n\n🩺 उपलब्ध सेवाएं:\n• लक्षण जांच (अपने लक्षण बताएं)\n• टीकाकरण जानकारी\n• आहार और पोषण सलाह\n• व्यायाम सिफारिशें\n• मानसिक स्वास्थ्य जागरूकता\n• स्वास्थ्य रिमाइंडर सेट करना\n\n💬 उदाहरण प्रश्न:\n• "मुझे बुखार और खांसी है"\n• "टीकों के बारे में बताएं"\n• "स्वास्थ्य सुझाव दें"\n• "मैं तनावग्रस्त महसूस कर रहा हूँ"\n\n⚠️ याद रखें: यह केवल जागरूकता की जानकारी है।` :
                `I'm here to provide health awareness information. You can ask me about:\n\n🩺 Available Services:\n• Symptom checking (describe your symptoms)\n• Vaccination information\n• Diet and nutrition advice\n• Exercise recommendations\n• Mental health awareness\n• Setting health reminders\n\n💬 Example Questions:\n• "I have fever and cough"\n• "Tell me about vaccines"\n• "Give me health tips"\n• "I'm feeling stressed"\n\nFor specific symptoms, describe them and I'll provide possible conditions for awareness.\n\n⚠️ Remember: This is only awareness information.`;
            
            return { text: response, isEmergency: false };
        }

        // Enhanced messaging functions
        function quickMessage(message) {
            sendMessage(message);
        }

        function sendMessage(messageText = null) {
            const messageInput = document.getElementById('message-input');
            const message = messageText || messageInput.value.trim();
            
            if (!message) return;
            
            // Add user message
            addUserMessage(message);
            messageInput.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            // Generate response with realistic delay
            setTimeout(() => {
                hideTypingIndicator();
                const response = generateResponse(message);
                addBotMessage(response.text, response.isEmergency);
                
                // Save to chat history
                saveChatHistory();
            }, Math.random() * 2000 + 1500);
        }

        // Chat history persistence
        function saveChatHistory() {
            if (!appState.currentUser) return;
            
            const chatMessages = document.getElementById('chat-messages');
            const messages = Array.from(chatMessages.children).map(msg => ({
                html: msg.innerHTML,
                className: msg.className,
                timestamp: new Date().toISOString()
            }));
            
            appState.chatHistory[appState.currentUser] = messages;
            localStorage.setItem('healthbot_chats', JSON.stringify(appState.chatHistory));
        }

        function loadChatHistory() {
            if (!appState.currentUser || !appState.chatHistory[appState.currentUser]) return;
            
            const chatMessages = document.getElementById('chat-messages');
            const history = appState.chatHistory[appState.currentUser];
            
            // Load only recent messages (last 50)
            const recentMessages = history.slice(-50);
            recentMessages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = msg.className;
                messageDiv.innerHTML = msg.html;
                chatMessages.appendChild(messageDiv);
            });
            
            scrollToBottom();
        }

        function clearChat() {
            if (confirm('Are you sure you want to clear the chat history?')) {
                clearChatMessages();
                initializeChatMessages();
                
                if (appState.currentUser) {
                    delete appState.chatHistory[appState.currentUser];
                    localStorage.setItem('healthbot_chats', JSON.stringify(appState.chatHistory));
                }
            }
        }

        function clearChatMessages() {
            document.getElementById('chat-messages').innerHTML = '';
            appState.messageCount = 0;
            updateChatStats();
        }

        // Utility functions
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatMessage(message) {
            return message.replace(/\n/g, '<br>').replace(/•/g, '&bull;');
        }

        function scrollToBottom() {
            const chatMessages = document.getElementById('chat-messages');
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function focusMessageInput() {
            setTimeout(() => {
                const input = document.getElementById('message-input');
                if (input) input.focus();
            }, 100);
        }

        // Enhanced reminder system
        function showReminderModal() {
            const modal = new bootstrap.Modal(document.getElementById('reminderModal'));
            modal.show();
        }

        function saveReminder() {
            const reminderText = document.getElementById('reminderText').value.trim();
            const reminderDays = parseInt(document.getElementById('reminderDays').value);
            const reminderDaysText = document.getElementById('reminderDays').selectedOptions[0].text;
            
            if (!reminderText) {
                alert('Please enter a reminder text');
                return;
            }
            
            // Calculate reminder date
            const reminderDate = new Date();
            reminderDate.setDate(reminderDate.getDate() + reminderDays);
            
            // Save reminder
            const reminder = {
                id: Date.now(),
                user: appState.currentUser,
                text: reminderText,
                days: reminderDays,
                dueDate: reminderDate.toISOString(),
                created: new Date().toISOString()
            };
            
            appState.reminders.push(reminder);
            localStorage.setItem('healthbot_reminders', JSON.stringify(appState.reminders));
            
            const response = appState.currentLanguage === 'hi' ?
                `✅ रिमाइंडर सफलतापूर्वक सेट किया गया!\n\nमैं आपको "${reminderText}" के बारे में ${reminderDaysText} में (${reminderDate.toLocaleDateString()}) याद दिलाऊंगा।\n\n📱 नोट: पूर्ण एप्लिकेशन में, आपको वास्तविक ईमेल/SMS सूचनाएं प्राप्त होंगी।` :
                `✅ Reminder set successfully!\n\nI'll remind you about "${reminderText}" in ${reminderDaysText} (${reminderDate.toLocaleDateString()}).\n\n📱 Note: In the full application, you would receive actual email/SMS notifications.`;
            
            addBotMessage(response);
            
            // Hide modal and reset form
            const modal = bootstrap.Modal.getInstance(document.getElementById('reminderModal'));
            modal.hide();
            document.getElementById('reminderText').value = '';
            document.getElementById('reminderDays').selectedIndex = 2;
        }

        // UI enhancement functions
        function updateStatusIndicator(page) {
            const indicator = document.getElementById('status-indicator');
            const langToggle = document.getElementById('lang-toggle');
            
            if (page === 'chat') {
                indicator.style.display = 'block';
                indicator.innerHTML = '<i class="fas fa-wifi me-2"></i>Connected';
                langToggle.style.display = 'block';
            } else {
                indicator.style.display = 'none';
                langToggle.style.display = 'none';
            }
        }

        function updateChatStats() {
            const statsElement = document.getElementById('chat-stats');
            const messageCountElement = document.getElementById('message-count');
            const sessionTimeElement = document.getElementById('session-time');
            
            if (messageCountElement) {
                messageCountElement.textContent = appState.messageCount;
            }
            
            if (sessionTimeElement) {
                const sessionDuration = Math.floor((Date.now() - appState.sessionStart) / 1000);
                const minutes = Math.floor(sessionDuration / 60);
                const seconds = sessionDuration % 60;
                sessionTimeElement.textContent = minutes > 0 ? `${minutes}m ${seconds}s` : `${seconds}s`;
            }
        }

        function startSessionTimer() {
            appState.sessionStart = Date.now();
            setInterval(updateChatStats, 1000);
        }

        function showEmergencyNotification() {
            // Create emergency notification
            const notification = document.createElement('div');
            notification.className = 'alert alert-danger position-fixed';
            notification.style.cssText = 'top: 80px; right: 20px; z-index: 1050; max-width: 300px;';
            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas fa-exclamation-triangle fa-2x me-3 text-danger"></i>
                    <div>
                        <strong>Emergency Detected!</strong><br>
                        <small>Seek immediate medical attention</small>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 5000);
            
            // Simulate notification sound
            console.log('🚨 EMERGENCY ALERT SOUND 🚨');
        }

        function toggleLanguage() {
            appState.currentLanguage = appState.currentLanguage === 'en' ? 'hi' : 'en';
            document.getElementById('lang-text').textContent = appState.currentLanguage.toUpperCase();
            
            const toggleBtn = document.getElementById('lang-toggle');
            toggleBtn.style.background = appState.currentLanguage === 'hi' ? 
                'linear-gradient(45deg, #ff9a56, #ff6b35)' : 'rgba(255,255,255,0.9)';
            
            addBotMessage(
                appState.currentLanguage === 'hi' ? 
                '🌐 भाषा हिंदी में बदल गई। अब आप हिंदी में सवाल पूछ सकते हैं!' :
                '🌐 Language switched to English. You can now ask questions in English!'
            );
        }

        // Event listeners
        document.getElementById('send-btn').addEventListener('click', () => sendMessage());
        document.getElementById('message-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            showLanding();
            
            // Add demo user for testing
            if (!appState.users['demo']) {
                appState.users['demo'] = {
                    email: 'demo@healthbot.com',
                    password: hashPassword('password'),
                    created: new Date().toISOString(),
                    lastLogin: null
                };
                localStorage.setItem('healthbot_users', JSON.stringify(appState.users));
            }
            
            // Show welcome animation
            setTimeout(() => {
                const heroSection = document.querySelector('.hero-section');
                if (heroSection) {
                    heroSection.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        heroSection.style.transform = 'scale(1)';
                    }, 200);
                }
            }, 1000);
        });

        // Add some interactive demo features
        function addInteractiveFeatures() {
            // Add hover effects to feature cards
            document.querySelectorAll('.feature-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-10px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });
            
            // Add click effects to buttons
            document.querySelectorAll('.btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 100);
                });
            });
        }

        // Add realistic chat delays and improvements
        function addTypingDelay(callback, message) {
            const typingTime = Math.min(message.length * 30, 3000); // Max 3 seconds
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                callback();
            }, typingTime);
        }

        // Enhanced error handling
        window.addEventListener('error', function(e) {
            console.error('Application Error:', e.error);
            
            if (document.getElementById('chat').classList.contains('active')) {
                addBotMessage(
                    '⚠️ I encountered a technical issue. Please try again or refresh the page if the problem persists.\n\nThis is a demo version - in the full application, errors are handled more gracefully.'
                );
            }
        });

        // Add localStorage cleanup for demo
        function cleanupOldData() {
            const maxEntries = 100;
            Object.keys(appState.chatHistory).forEach(user => {
                if (appState.chatHistory[user].length > maxEntries) {
                    appState.chatHistory[user] = appState.chatHistory[user].slice(-maxEntries);
                }
            });
            localStorage.setItem('healthbot_chats', JSON.stringify(appState.chatHistory));
        }

        // Periodically cleanup old data
        setInterval(cleanupOldData, 60000); // Every minute

        // Add demo data and examples
        setTimeout(() => {
            addInteractiveFeatures();
        }, 500);

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // ESC to close modals
            if (e.key === 'Escape') {
                const openModal = document.querySelector('.modal.show');
                if (openModal) {
                    const modalInstance = bootstrap.Modal.getInstance(openModal);
                    if (modalInstance) modalInstance.hide();
                }
            }
            
            // Ctrl+L to toggle language (in chat)
            if (e.ctrlKey && e.key === 'l' && document.getElementById('chat').classList.contains('active')) {
                e.preventDefault();
                toggleLanguage();
            }
            
            // Ctrl+K to focus message input
            if (e.ctrlKey && e.key === 'k' && document.getElementById('chat').classList.contains('active')) {
                e.preventDefault();
                focusMessageInput();
            }
        });

        // Performance monitoring
        let performanceMetrics = {
            pageLoads: 0,
            messagesSent: 0,
            errorsOccurred: 0
        };

        // Add performance tracking
        function trackPerformance(action) {
            performanceMetrics[action] = (performanceMetrics[action] || 0) + 1;
            localStorage.setItem('healthbot_performance', JSON.stringify(performanceMetrics));
        }

        // Add accessibility improvements
        function improveAccessibility() {
            // Add ARIA labels
            document.getElementById('message-input').setAttribute('aria-label', 'Type your health question');
            document.getElementById('send-btn').setAttribute('aria-label', 'Send message');
            
            // Add role attributes
            document.getElementById('chat-messages').setAttribute('role', 'log');
            document.getElementById('chat-messages').setAttribute('aria-live', 'polite');
            
            // Improve focus management
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('shown.bs.modal', function() {
                    const firstInput = this.querySelector('input, textarea, select');
                    if (firstInput) firstInput.focus();
                });
            });
        }

        // Initialize accessibility features
        setTimeout(improveAccessibility, 100);

        // Add final demo message when everything is loaded
        window.addEventListener('load', function() {
            console.log('🎉 Health Chatbot Demo Fully Loaded!');
            console.log('✅ Features: Authentication, Symptom Checking, Multilingual, Reminders');
            console.log('🔧 Try: Login with demo/password, or create new account, or use Try Demo');
            
            trackPerformance('pageLoads');
        });
    </script>
</body>
</html>